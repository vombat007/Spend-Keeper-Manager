#:import CircularChart kivy_app.widget.custom_chart.CircularChart

<CustomButton@Button>:
    background_normal: 'kivy_app/assets/img/Rectangle_normal.png'
    background_down: 'kivy_app/assets/img/Rectangle_down.png'
    font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
    color: 0, 0, 0, 1

<HomeScreen>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            size: self.size
            pos: self.pos

    sidebar: sidebar_menu_id
    chart: chart_id
    income_label: income_label_id
    expense_label: expense_label_id
    period_label: period_label_id
    FloatLayout:
        SidebarMenu:
            id: sidebar_menu_id
            size_hint: None, 1
            width: 250
            x: -self.width

        CustomSidebarButton:
            id: sidebar_toggle_button
            size_hint: None, None
            size: '54dp', '53dp'
            pos_hint: {'x': 0, 'y': 0.90}
            on_release: root.toggle_sidebar()

        BoxLayout:
            orientation: 'vertical'
            size_hint: 1, None
            height: self.height
            pos_hint: {'y': 0.02}  # Small indent from the bottom

            BoxLayout:
                orientation: 'horizontal'
                size_hint: None, None
                size: 340, 50
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}  # Center the box layout
                spacing: 40  # Add spacing between elements

                Button:
                    background_normal: 'kivy_app/assets/img/Big_arrow_left_normal.png'
                    background_down: 'kivy_app/assets/img/Big_arrow_left_down.png'
                    size_hint: None, None
                    size: 29, 60
                    pos_hint: {'center_x': 0.5, 'y': 1.4}
                    on_release: root.switch_account(-1)

                CircularChart:
                    id: chart_id
                    size_hint: None, None
                    size: 200, 200

                Button:
                    background_normal: 'kivy_app/assets/img/Big_arrow_right_normal.png'
                    background_down: 'kivy_app/assets/img/Big_arrow_right_down.png'
                    size_hint: None, None
                    size: 29, 60
                    pos_hint: {'center_x': 0.5, 'y': 1.4}
                    on_release: root.switch_account(1)

            BoxLayout:
                orientation: 'horizontal'
                size_hint: None, None
                size: 300, 50
                pos_hint: {'center_x': 0.5, 'center_y': 0.7}
                spacing: 140

                BoxLayout:
                    orientation: 'horizontal'
                    size_hint: None, None
                    size: 90, 32
                    spacing: 5

                    FloatLayout:
                        size_hint: None, None
                        size: 32, 32
                        canvas.before:
                            Color:
                                rgba: 1, 1, 0, 1  # Yellow color
                            Ellipse:
                                size: self.size
                                pos: self.pos
                            Color:
                                rgba: 0, 0, 0, 1  # Black color for outline
                            Line:
                                width: 1
                                ellipse: (self.x, self.y, self.width, self.height)

                    Label:
                        text: 'Left'
                        font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
                        size_hint: None, None
                        size: 50, 32
                        valign: 'middle'
                        halign: 'left'
                        color: 0, 0, 0, 1
                        text_size: self.size

                BoxLayout:
                    orientation: 'horizontal'
                    size_hint: None, None
                    size: 90, 32
                    spacing: 5

                    FloatLayout:
                        size_hint: None, None
                        size: 32, 32
                        canvas.before:
                            Color:
                                rgba: 0.788, 0.788, 0.788, 1  # Gray color
                            Ellipse:
                                size: self.size
                                pos: self.pos
                            Color:
                                rgba: 0, 0, 0, 1  # Black color for outline
                            Line:
                                width: 1
                                ellipse: (self.x, self.y, self.width, self.height)

                    Label:
                        text: 'Spend'
                        font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
                        size_hint: None, None
                        size: 50, 32
                        valign: 'middle'
                        halign: 'left'
                        color: 0, 0, 0, 1
                        text_size: self.size

            BoxLayout:
                orientation: 'horizontal'
                size_hint: None, None
                size: 385, 50
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                spacing: 10

                CustomButton:
                    id: day_button
                    text: 'Day'
                    size_hint: None, None
                    size: 70, 35
                    on_release:
                        root.set_period('day')
                        self.state = 'down'

                CustomButton:
                    id: week_button
                    text: 'Week'
                    size_hint: None, None
                    size: 70, 35
                    on_release:
                        root.set_period('week')
                        self.state = 'down'

                CustomButton:
                    id: month_button
                    text: 'Month'
                    size_hint: None, None
                    size: 70, 35
                    on_release:
                        root.set_period('month')
                        self.state = 'down'

                CustomButton:
                    id: year_button
                    text: 'Year'
                    size_hint: None, None
                    size: 70, 35
                    on_release:
                        root.set_period('year')
                        self.state = 'down'

                CustomButton:
                    id: period_button
                    text: 'Period'
                    size_hint: None, None
                    size: 70, 35
                    on_release:
                        root.set_period('period')
                        self.state = 'down'

            BoxLayout:
                orientation: 'horizontal'
                size_hint: None, None
                size: 340, 50
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                spacing: 10

                Button:
                    id: left_arrow_button
                    size_hint: None, None
                    size: 45, 32
                    background_normal: 'kivy_app/assets/img/Button_arrow_left_normal.png'
                    background_down: 'kivy_app/assets/img/Button_arrow_left_down.png'
                    on_release:
                        root.change_period(-1)
                        root.update_button_visibility()

                Button:
                    id: period_label_id
                    text: ''
                    font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
                    background_normal: 'kivy_app/assets/img/Rectangle_normal.png'
                    background_down: 'kivy_app/assets/img/Rectangle_normal.png'
                    size_hint: None, None
                    size: 220, 32
                    valign: 'middle'
                    halign: 'center'
                    color: 0, 0, 0, 1
                    text_size: self.size

                Button:
                    id: right_arrow_button
                    background_normal: 'kivy_app/assets/img/Button_arrow_right_normal.png'
                    background_down: 'kivy_app/assets/img/Button_arrow_right_down.png'
                    background_disabled_normal: ''
                    size_hint: None, None
                    size: 45, 32
                    disabled_color: 1, 1, 1, 0  # Fully transparent
                    on_release:
                        root.change_period(1)
                        root.update_button_visibility()

            BoxLayout:
                orientation: 'vertical'
                size_hint: None, None
                size: 350, 250
                padding: [10, 10, 10, 0]
                spacing: 10
                pos_hint: {'center_x': 0.5, 'y': 0.1}  # Adjusted indent from the bottom

                BoxLayout:
                    orientation: 'vertical'
                    size_hint: None, None
                    size: 330, 110
                    padding: [10]
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [20,]

                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            width: 3
                            rounded_rectangle: (*self.pos, *self.size, 20)
                        # Yellow inner outline
                        Color:
                            rgba: 1, 1, 0, 1
                        Line:
                            width: 4
                            rounded_rectangle: (self.x + 5, self.y + 5, self.width - 10, self.height - 10, 20)

                    Label:
                        id: income_label_id
                        text: "Income"
                        font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
                        font_size: 24
                        color: 0, 0, 0, 1
                        padding: [0, 30, 0, 0]  # Add padding to move text down

                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: None, None
                        size: 32, 32
                        spacing: 5
                        pos_hint:  {'center_x': 0.85, 'y': 1.30}

                        Button:
                            text: "+"
                            size_hint: None, None
                            size: 32, 32
                            pos_hint:  {'center_x': 0.85, 'y': 1}
                            on_press: on_press: root.go_transaction('income')


                BoxLayout:
                    orientation: 'vertical'
                    size_hint: None, None
                    size: 330, 110
                    padding: [10]
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [20,]

                        Color:
                            rgba: 0, 0, 0, 1
                        Line:
                            width: 3
                            rounded_rectangle: (*self.pos, *self.size, 20)
                        # Yellow inner outline
                        Color:
                            rgba: 0.788, 0.788, 0.788, 1
                        Line:
                            width: 4
                            rounded_rectangle: (self.x + 5, self.y + 5, self.width - 10, self.height - 10, 20)


                    Label:
                        id: expense_label_id
                        text: "Expense"
                        font_name: 'kivy_app/assets/fonts/IrishGrover-Regular.ttf'
                        font_size: 24
                        color: 0, 0, 0, 1
                        padding: [0, 30, 0, 0]  # Add padding to move text down

                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: None, None
                        size: 32, 32
                        spacing: 5
                        pos_hint:  {'center_x': 0.85, 'y': 1.30}

                        Button:
                            text: "+"
                            size_hint: None, None
                            size: 32, 32
                            pos_hint:  {'center_x': 0.85, 'y': 1}
                            on_press: root.go_transaction('expense')
